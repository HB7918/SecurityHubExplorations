{
  "version": 3,
  "sources": ["../../src/popover/index.tsx", "../../src/popover/internal.tsx", "../../src/internal/context/reset-contexts-for-modal.tsx", "../../src/popover/conditional-live-region.tsx"],
  "sourcesContent": ["// Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n// SPDX-License-Identifier: Apache-2.0\n'use client';\nimport React from 'react';\n\nimport { warnOnce } from '@cloudscape-design/component-toolkit/internal';\n\nimport useBaseComponent from '../internal/hooks/use-base-component';\nimport { isDevelopment } from '../internal/is-development';\nimport { applyDisplayName } from '../internal/utils/apply-display-name';\nimport { getExternalProps } from '../internal/utils/external-props';\nimport { PopoverProps } from './interfaces';\nimport InternalPopover from './internal';\n\nexport { PopoverProps };\n\nconst Popover = React.forwardRef(\n  (\n    {\n      position = 'right',\n      size = 'medium',\n      fixedWidth = false,\n      triggerType = 'text',\n      dismissButton = true,\n      renderWithPortal = false,\n      wrapTriggerText = true,\n      header,\n      ...rest\n    }: PopoverProps,\n    ref: React.Ref<PopoverProps.Ref>\n  ) => {\n    if (isDevelopment) {\n      if (dismissButton && !header) {\n        warnOnce('Popover', `You should provide a \\`header\\` when \\`dismissButton\\` is true.`);\n      }\n    }\n\n    const baseComponentProps = useBaseComponent('Popover', {\n      props: { dismissButton, fixedWidth, position, renderWithPortal, size, triggerType },\n    });\n    const externalProps = getExternalProps(rest);\n\n    return (\n      <InternalPopover\n        ref={ref}\n        header={header}\n        position={position}\n        size={size}\n        fixedWidth={fixedWidth}\n        triggerType={triggerType}\n        dismissButton={dismissButton}\n        renderWithPortal={renderWithPortal}\n        wrapTriggerText={wrapTriggerText}\n        {...externalProps}\n        {...baseComponentProps}\n      />\n    );\n  }\n);\n\napplyDisplayName(Popover, 'Popover');\nexport default Popover;\n", "// Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n// SPDX-License-Identifier: Apache-2.0\nimport React, { useCallback, useEffect, useImperativeHandle, useRef, useState } from 'react';\nimport clsx from 'clsx';\n\nimport { Portal, useMergeRefs, useUniqueId } from '@cloudscape-design/component-toolkit/internal';\nimport { useSingleTabStopNavigation } from '@cloudscape-design/component-toolkit/internal';\n\nimport { useInternalI18n } from '../i18n/context';\nimport { getBaseProps } from '../internal/base-component';\nimport { getFirstFocusable } from '../internal/components/focus-lock/utils';\nimport { LinkDefaultVariantContext } from '../internal/context/link-default-variant-context';\nimport ResetContextsForModal from '../internal/context/reset-contexts-for-modal';\nimport { fireNonCancelableEvent, NonCancelableEventHandler } from '../internal/events/index';\nimport { InternalBaseComponentProps } from '../internal/hooks/use-base-component';\nimport { usePortalModeClasses } from '../internal/hooks/use-portal-mode-classes';\nimport { KeyCode } from '../internal/keycode';\nimport Arrow from './arrow';\nimport PopoverBody from './body';\nimport ConditionalLiveRegion from './conditional-live-region';\nimport PopoverContainer from './container';\nimport { PopoverProps } from './interfaces';\n\nimport styles from './styles.css.js';\n\nexport interface InternalPopoverProps extends Omit<PopoverProps, 'triggerType' | 'size'>, InternalBaseComponentProps {\n  __onOpen?: NonCancelableEventHandler<null>;\n  triggerType?: PopoverProps.TriggerType | 'filtering-token';\n  size: PopoverProps.Size | 'content';\n  __closeAnalyticsAction?: string;\n  isInline?: boolean;\n}\n\nexport default React.forwardRef(InternalPopover);\n\nfunction InternalPopover(\n  {\n    position = 'right',\n    size = 'medium',\n    fixedWidth = false,\n    triggerType = 'text',\n    dismissButton = true,\n\n    children,\n    header,\n    content,\n    triggerAriaLabel,\n\n    wrapTriggerText = true,\n    isInline = false,\n    renderWithPortal = false,\n\n    __onOpen,\n    __internalRootRef,\n    __closeAnalyticsAction,\n\n    ...restProps\n  }: InternalPopoverProps,\n  ref: React.Ref<PopoverProps.Ref>\n) {\n  const baseProps = getBaseProps(restProps);\n  const triggerRef = useRef<HTMLElement | null>(null);\n  const popoverRef = useRef<HTMLDivElement | null>(null);\n\n  const i18n = useInternalI18n('popover');\n  const dismissAriaLabel = i18n('dismissAriaLabel', restProps.dismissAriaLabel);\n\n  const [visible, setVisible] = useState(false);\n\n  const focusTrigger = useCallback(() => {\n    if (['text', 'text-inline'].includes(triggerType)) {\n      triggerRef.current?.focus();\n    } else if (triggerRef.current) {\n      getFirstFocusable(triggerRef.current)?.focus();\n    }\n  }, [triggerType]);\n\n  const onTriggerClick = useCallback(() => {\n    fireNonCancelableEvent(__onOpen);\n    setVisible(true);\n  }, [__onOpen]);\n\n  const onDismiss = useCallback(() => {\n    setVisible(false);\n    focusTrigger();\n  }, [focusTrigger]);\n\n  const onTriggerKeyDown = useCallback(\n    (event: React.KeyboardEvent) => {\n      const isEscapeKey = event.keyCode === KeyCode.escape;\n      const isTabKey = event.keyCode === KeyCode.tab;\n      if (isEscapeKey && visible) {\n        event.stopPropagation();\n      }\n      if (isTabKey || isEscapeKey) {\n        setVisible(false);\n      }\n    },\n    [visible]\n  );\n\n  useImperativeHandle(ref, () => ({\n    dismiss: () => {\n      setVisible(false);\n    },\n    focus: () => {\n      setVisible(false);\n      focusTrigger();\n    },\n  }));\n\n  const clickFrameId = useRef<number | null>(null);\n  useEffect(() => {\n    if (!triggerRef.current) {\n      return;\n    }\n    const document = triggerRef.current.ownerDocument;\n\n    const onDocumentClick = () => {\n      // Dismiss popover unless there was a click inside within the last animation frame.\n      if (clickFrameId.current === null) {\n        setVisible(false);\n      }\n    };\n\n    document.addEventListener('mousedown', onDocumentClick);\n\n    return () => {\n      document.removeEventListener('mousedown', onDocumentClick);\n    };\n  }, []);\n\n  const popoverClasses = usePortalModeClasses(triggerRef, { resetVisualContext: true });\n\n  const triggerProps = {\n    // https://github.com/microsoft/TypeScript/issues/36659\n    ref: triggerRef as any,\n    onClick: onTriggerClick,\n    onKeyDown: onTriggerKeyDown,\n    className: clsx(styles.trigger, styles[`trigger-type-${triggerType}`]),\n  };\n  const { tabIndex: triggerTabIndex } = useSingleTabStopNavigation(triggerRef);\n\n  const referrerId = useUniqueId();\n\n  const popoverContent = (\n    <div\n      className={clsx(popoverClasses, !renderWithPortal && styles['popover-inline-content'])}\n      data-awsui-referrer-id={referrerId}\n    >\n      <PopoverContainer\n        size={size}\n        fixedWidth={fixedWidth}\n        position={position}\n        trackRef={triggerRef}\n        arrow={position => <Arrow position={position} />}\n        renderWithPortal={renderWithPortal}\n        zIndex={renderWithPortal ? 7000 : undefined}\n      >\n        <LinkDefaultVariantContext.Provider value={{ defaultVariant: 'primary' }}>\n          <PopoverBody\n            dismissButton={dismissButton}\n            dismissAriaLabel={dismissAriaLabel}\n            header={header}\n            onDismiss={onDismiss}\n            overflowVisible=\"both\"\n            closeAnalyticsAction={__closeAnalyticsAction}\n          >\n            <ConditionalLiveRegion condition={!dismissButton}>{content}</ConditionalLiveRegion>\n          </PopoverBody>\n        </LinkDefaultVariantContext.Provider>\n      </PopoverContainer>\n    </div>\n  );\n\n  const mergedRef = useMergeRefs(popoverRef, __internalRootRef);\n\n  return (\n    <span\n      {...baseProps}\n      className={clsx(\n        styles.root,\n        baseProps.className,\n        triggerType === 'filtering-token' && styles['root-filtering-token'],\n        isInline && styles['no-wrap']\n      )}\n      ref={mergedRef}\n      onMouseDown={() => {\n        // Indicate there was a click inside popover recently, including nested portals.\n        clickFrameId.current = requestAnimationFrame(() => {\n          clickFrameId.current = null;\n        });\n      }}\n    >\n      {['text', 'text-inline'].includes(triggerType) ? (\n        <button\n          {...triggerProps}\n          className={clsx(triggerProps.className, wrapTriggerText === false && styles['overflow-ellipsis'])}\n          tabIndex={triggerTabIndex}\n          type=\"button\"\n          aria-haspopup=\"dialog\"\n          id={referrerId}\n          aria-label={triggerAriaLabel}\n        >\n          {children}\n        </button>\n      ) : (\n        <span {...triggerProps} id={referrerId}>\n          {children}\n        </span>\n      )}\n      {visible && (\n        <ResetContextsForModal>\n          {renderWithPortal ? <Portal>{popoverContent}</Portal> : popoverContent}\n        </ResetContextsForModal>\n      )}\n    </span>\n  );\n}\n", "// Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n// SPDX-License-Identifier: Apache-2.0\nimport React from 'react';\n\nimport { SingleTabStopNavigationReset } from '@cloudscape-design/component-toolkit/internal';\n\nimport { ButtonContext } from './button-context';\nimport { CollectionLabelContext } from './collection-label-context';\nimport { FormFieldContext } from './form-field-context';\nimport { InfoLinkLabelContext } from './info-link-label-context';\nimport { defaultValue as linkDefaultValue, LinkDefaultVariantContext } from './link-default-variant-context';\n\n/*\n Use this context-resetter when creating a new modal-type context where typically the contents\n of the modal should not be affected by the surrounding components/DOM.\n */\nconst ResetContextsForModal = ({ children }: { children: React.ReactNode }) => (\n  <ButtonContext.Provider value={{ onClick: () => {} }}>\n    <CollectionLabelContext.Provider value={{ assignId: () => {} }}>\n      <FormFieldContext.Provider value={{}}>\n        <InfoLinkLabelContext.Provider value=\"\">\n          <LinkDefaultVariantContext.Provider value={linkDefaultValue}>\n            <SingleTabStopNavigationReset>{children}</SingleTabStopNavigationReset>\n          </LinkDefaultVariantContext.Provider>\n        </InfoLinkLabelContext.Provider>\n      </FormFieldContext.Provider>\n    </CollectionLabelContext.Provider>\n  </ButtonContext.Provider>\n);\n\nexport default ResetContextsForModal;\n", "// Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n// SPDX-License-Identifier: Apache-2.0\nimport React, { ReactNode } from 'react';\n\nimport InternalLiveRegion from '../live-region/internal';\n\ninterface ConditionalLiveRegionProps {\n  condition: boolean;\n  children: ReactNode;\n}\n\nconst ConditionalLiveRegion = ({ condition, children }: ConditionalLiveRegionProps) => {\n  if (condition) {\n    return <InternalLiveRegion>{children}</InternalLiveRegion>;\n  }\n  return <>{children}</>;\n};\n\nexport default ConditionalLiveRegion;\n"],
  "mappings": "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",
  "names": ["import_react", "import_react", "React", "import_react", "React", "internal_default", "React", "position", "React", "internal_default"]
}
